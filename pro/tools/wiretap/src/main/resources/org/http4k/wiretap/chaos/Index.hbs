{{#>org/http4k/wiretap/layout pageTitle="Chaos"}}
{{#partial "body"}}
<body data-signals="{{{initialSignals}}}">
{{> org/http4k/wiretap/header}}
<div class="chaos-page">
    <div id="chaos-status" class="chaos-status-panel" data-init="@get('/__wiretap/chaos/status')">
    </div>

    <div class="chaos-sections">
        <div class="chaos-section">
            <h3><i class="bi bi-arrow-down-circle"></i> Inbound Chaos</h3>
            <p class="chaos-section-desc">Simulate your application misbehaving for incoming requests</p>
            <div class="chaos-form">
                <div class="chaos-form-group">
                    <label>Behaviour</label>
                    <select class="form-select form-select-sm" data-bind="inBehaviour">
                        <option value="ReturnStatus">Return Status</option>
                        <option value="Latency">Latency</option>
                        <option value="NoBody">No Body</option>
                    </select>
                </div>
                <div class="chaos-form-group" data-show="$inBehaviour==='Latency'">
                    <label>Min (ms)</label>
                    <input type="number" class="form-control form-control-sm" data-bind="inLatencyMin" value="100">
                </div>
                <div class="chaos-form-group" data-show="$inBehaviour==='Latency'">
                    <label>Max (ms)</label>
                    <input type="number" class="form-control form-control-sm" data-bind="inLatencyMax" value="500">
                </div>
                <div class="chaos-form-group" data-show="$inBehaviour==='ReturnStatus'">
                    <label>Status Code</label>
                    <input type="number" class="form-control form-control-sm" data-bind="inStatusCode" value="500">
                </div>
                <div class="chaos-form-group">
                    <label>Filter</label>
                </div>
                <div class="chaos-form-group">
                    <label>Method</label>
                    <select class="form-select form-select-sm" data-bind="inMethod">
                        <option value="">Any</option>
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="PATCH">PATCH</option>
                    </select>
                </div>
                <div class="chaos-form-group">
                    <label>Path</label>
                    <input type="text" class="form-control form-control-sm" data-bind="inPath" placeholder="Match path...">
                </div>
                <div class="chaos-form-group">
                    <label>Host</label>
                    <input type="text" class="form-control form-control-sm" data-bind="inHost" placeholder="Match host...">
                </div>
                <div class="chaos-form-group">
                    <label>Trigger</label>
                    <select class="form-select form-select-sm" data-bind="inTrigger">
                        <option value="Always">Always</option>
                        <option value="PercentageBased">Percentage Based</option>
                        <option value="Once">Once</option>
                        <option value="Countdown">Countdown</option>
                    </select>
                </div>
                <div class="chaos-form-group" data-show="$inTrigger==='PercentageBased'">
                    <label>Percentage</label>
                    <input type="number" class="form-control form-control-sm" data-bind="inPercentage" min="0" max="100" value="50">
                </div>
                <div class="chaos-form-group" data-show="$inTrigger==='Countdown'">
                    <label>Count</label>
                    <input type="number" class="form-control form-control-sm" data-bind="inCountdown" min="0" value="5">
                </div>
                <div class="chaos-actions">
                    <button class="btn btn-sm btn-danger"
                            data-on:click="@post('/__wiretap/chaos/Inbound/activate', {signals: {behaviour: $inBehaviour, latencyMin: $inLatencyMin, latencyMax: $inLatencyMax, statusCode: $inStatusCode, trigger: $inTrigger, percentage: $inPercentage, countdown: $inCountdown, method: $inMethod, path: $inPath, host: $inHost}})">
                        Activate
                    </button>
                    <button class="btn btn-sm btn-outline-secondary"
                            data-on:click="@post('/__wiretap/chaos/Inbound/deactivate')">
                        Deactivate
                    </button>
                </div>
            </div>
        </div>

        <div class="chaos-section">
            <h3><i class="bi bi-arrow-up-circle"></i> Outbound Chaos</h3>
            <p class="chaos-section-desc">Simulate your dependencies misbehaving for outgoing requests</p>
            <div class="chaos-form">
                <div class="chaos-form-group">
                    <label>Behaviour</label>
                    <select class="form-select form-select-sm" data-bind="outBehaviour">
                        <option value="ReturnStatus">Return Status</option>
                        <option value="Latency">Latency</option>
                        <option value="NoBody">No Body</option>
                    </select>
                </div>
                <div class="chaos-form-group" data-show="$outBehaviour==='Latency'">
                    <label>Min (ms)</label>
                    <input type="number" class="form-control form-control-sm" data-bind="outLatencyMin" value="100">
                </div>
                <div class="chaos-form-group" data-show="$outBehaviour==='Latency'">
                    <label>Max (ms)</label>
                    <input type="number" class="form-control form-control-sm" data-bind="outLatencyMax" value="500">
                </div>
                <div class="chaos-form-group" data-show="$outBehaviour==='ReturnStatus'">
                    <label>Status Code</label>
                    <input type="number" class="form-control form-control-sm" data-bind="outStatusCode" value="500">
                </div>
                <div class="chaos-form-group">
                    <label>Filter</label>
                </div>
                <div class="chaos-form-group">
                    <label>Method</label>
                    <select class="form-select form-select-sm" data-bind="outMethod">
                        <option value="">Any</option>
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="PATCH">PATCH</option>
                    </select>
                </div>
                <div class="chaos-form-group">
                    <label>Path</label>
                    <input type="text" class="form-control form-control-sm" data-bind="outPath" placeholder="Match path...">
                </div>
                <div class="chaos-form-group">
                    <label>Host</label>
                    <input type="text" class="form-control form-control-sm" data-bind="outHost" placeholder="Match host...">
                </div>
                <div class="chaos-form-group">
                    <label>Trigger</label>
                    <select class="form-select form-select-sm" data-bind="outTrigger">
                        <option value="Always">Always</option>
                        <option value="PercentageBased">Percentage Based</option>
                        <option value="Once">Once</option>
                        <option value="Countdown">Countdown</option>
                    </select>
                </div>
                <div class="chaos-form-group" data-show="$outTrigger==='PercentageBased'">
                    <label>Percentage</label>
                    <input type="number" class="form-control form-control-sm" data-bind="outPercentage" min="0" max="100" value="50">
                </div>
                <div class="chaos-form-group" data-show="$outTrigger==='Countdown'">
                    <label>Count</label>
                    <input type="number" class="form-control form-control-sm" data-bind="outCountdown" min="0" value="5">
                </div>
                <div class="chaos-actions">
                    <button class="btn btn-sm btn-danger"
                            data-on:click="@post('/__wiretap/chaos/Outbound/activate', {signals: {behaviour: $outBehaviour, latencyMin: $outLatencyMin, latencyMax: $outLatencyMax, statusCode: $outStatusCode, trigger: $outTrigger, percentage: $outPercentage, countdown: $outCountdown, method: $outMethod, path: $outPath, host: $outHost}})">
                        Activate
                    </button>
                    <button class="btn btn-sm btn-outline-secondary"
                            data-on:click="@post('/__wiretap/chaos/Outbound/deactivate')">
                        Deactivate
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
{{/partial}}
{{/layout}}
